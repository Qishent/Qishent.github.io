import"./base-BrLvHeEz.js";import{a as M,b as U,E as $}from"./el-form-item-CwfRYHZ6.js";import{E as z,a as L}from"./el-overlay-BMqcU0d2.js";import{E as j,a as q}from"./el-descriptions-item-Ca3zkLqe.js";import{a as G,E as H}from"./el-table-column-B1QPPeaY.js";import{E as J}from"./el-button-CtCx0wzE.js";/* empty css               */import{E as K}from"./el-card-H6DQ7_za.js";import{E as Q,a as R}from"./el-select-Bif_aSHU.js";import{u as W}from"./adminStore-BODfsJ-W.js";import{E as h}from"./el-message-CDeRKx3U.js";import{E as X}from"./index-ChXpIs1_.js";import{r as S,O as Y,c as Z,a as k,d as e,w as t,j as f,n,t as s,k as T,F as ee,g as te,e as ae}from"./index-BJ8CMOzX.js";import"./focus-trap-CbSkDzOF.js";import"./aria-Dcom87Zv.js";import"./index-BIpa8E9G.js";import"./use-global-config-lAPLHJ-8.js";import"./event-BB_Ol6Sd.js";import"./use-form-common-props-0hT0vvR3.js";import"./castArray-N6rEY9dZ.js";import"./error-Cq9Fpw4b.js";import"./index-BRO3r1ed.js";import"./index-DD6m2SLq.js";import"./vnode-Th6H0zNw.js";import"./debounce-DiltkV32.js";import"./token-DI9FKtlJ.js";const le={class:"data-container"},De={__name:"Orders",setup(oe){const E=W(),b=S(!1),r=S(null),C=a=>{r.value=a,b.value=!0},g=a=>{if(!a)return"N/A";try{return new Date(a).toLocaleString()}catch{return"无效日期"}},y=a=>{const o=Number(a);return isNaN(o)?"¥ 0.00":`¥ ${o.toFixed(2)}`},N=async a=>{try{await z.confirm("确定删除该订单？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),E.deleteOrder(a),h.success("删除成功")}catch{h.info("已取消删除")}},x={待付款:"danger",待发货:"warning",已发货:"primary",已完成:"success"},d=Y({orderId:"",status:""}),D=Z(()=>E.orders.filter(a=>{const v=String(a.orderId||"").includes(d.orderId),_=d.status?a.status===d.status:!0;return v&&_}).map(a=>({...a,orderId:String(a.orderId||"N/A"),orderTime:a.orderTime,status:a.status||"N/A",totalPrice:a.totalPrice||0,address:a.address||{},productions:a.productions||[]})));return(a,o)=>{const v=L,_=M,c=Q,B=R,O=U,I=K,p=G,w=X,V=J,F=H,u=j,A=q,P=$;return f(),k("div",le,[e(I,{shadow:"never",class:"mb-4"},{default:t(()=>[e(O,{inline:!0},{default:t(()=>[e(_,{label:"订单号"},{default:t(()=>[e(v,{modelValue:d.orderId,"onUpdate:modelValue":o[0]||(o[0]=l=>d.orderId=l),placeholder:"输入订单号",clearable:""},null,8,["modelValue"])]),_:1}),e(_,{label:"状态"},{default:t(()=>[e(B,{modelValue:d.status,"onUpdate:modelValue":o[1]||(o[1]=l=>d.status=l),placeholder:"全部",clearable:""},{default:t(()=>[e(c,{label:"全部",value:""}),e(c,{label:"待付款",value:"待付款"}),e(c,{label:"待发货",value:"待发货"}),e(c,{label:"已发货",value:"已发货"}),e(c,{label:"已完成",value:"已完成"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(I,null,{default:t(()=>[e(F,{data:D.value,stripe:"",style:{width:"100%"}},{default:t(()=>[e(p,{prop:"orderId",label:"订单号",width:"200"}),e(p,{prop:"orderTime",label:"下单时间",formatter:(l,i,m)=>g(m),width:"180"},null,8,["formatter"]),e(p,{prop:"totalPrice",label:"金额",align:"right",formatter:(l,i,m)=>y(m)},null,8,["formatter"]),e(p,{prop:"status",label:"状态",width:"120"},{default:t(({row:l})=>[e(w,{type:x[l.status]},{default:t(()=>[n(s(l.status),1)]),_:2},1032,["type"])]),_:1}),e(p,{label:"操作",width:"150"},{default:t(({row:l})=>[e(V,{size:"small",onClick:i=>C(l)},{default:t(()=>o[3]||(o[3]=[n("详情")])),_:2},1032,["onClick"]),e(V,{size:"small",type:"danger",onClick:i=>N(l.orderId)},{default:t(()=>o[4]||(o[4]=[n("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(P,{modelValue:b.value,"onUpdate:modelValue":o[2]||(o[2]=l=>b.value=l),title:"订单详情",width:"50%"},{default:t(()=>[r.value?(f(),T(A,{key:0,column:1,border:""},{default:t(()=>[e(u,{label:"订单号"},{default:t(()=>[n(s(r.value.orderId),1)]),_:1}),e(u,{label:"下单时间"},{default:t(()=>[n(s(g(r.value.orderTime)),1)]),_:1}),e(u,{label:"总金额"},{default:t(()=>[n(s(y(r.value.totalPrice)),1)]),_:1}),e(u,{label:"支付方式"},{default:t(()=>[n(s(r.value.paymentMethod),1)]),_:1}),e(u,{label:"收货地址"},{default:t(()=>{var l,i,m;return[n(s((l=r.value.address)==null?void 0:l.province)+s((i=r.value.address)==null?void 0:i.city)+s((m=r.value.address)==null?void 0:m.district),1)]}),_:1}),e(u,{label:"商品列表"},{default:t(()=>[(f(!0),k(ee,null,te(r.value.productions,l=>(f(),T(w,{key:l.id,class:"m-1"},{default:t(()=>[n(s(l.name)+" ×"+s(l.quantity),1)]),_:2},1024))),128))]),_:1})]),_:1})):ae("",!0)]),_:1},8,["modelValue"])]),_:1})])}}};export{De as default};
