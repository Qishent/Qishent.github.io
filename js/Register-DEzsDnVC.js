import{_ as se,u as oe,r as t,a as n,b as o,y as D,n as m,V as M,t as v,e as i,W as S,z as R,X as te,g as T,d as ae,w as re,F as le,j as ne,k as u,p as ue}from"./index-BAA_AMh7.js";import{r as U}from"./request-BxsLXbCj.js";import{u as ie}from"./adminStore-B6m40LsA.js";import"./base-4kfo36zp.js";import{E as c}from"./el-message-WK0GHmtc.js";import"./index-DZzn_qGS.js";import"./aria-Dcom87Zv.js";import"./use-global-config-DbqVAiVU.js";const de={class:"register-card"},ve={class:"input-box flex-item"},ce={key:0,class:"error-text"},fe={class:"input-box flex-item"},pe=["type"],me={key:1,class:"error-text"},we={class:"input-box flex-item"},ye=["type"],ge={key:1,class:"error-text"},Ee=["disabled"],he={class:"yzm"},xe={key:0,class:"error-text"},Pe={class:"flex-item"},be={key:0,class:"error-text"},Be={class:"filter flex-item"},ke=["disabled"],Ce={__name:"Register",setup(_e){const $=ue();oe(),ie();const d=t(""),q=t(!1),w=t(""),z=t(!1),C=t(!1),y=t(!1),g=t(""),L=t(!1),_=t(!1),E=t(!1),f=t(0),h=t(!1),x=t(!1),P=t(!1),A=t(!1),p=t(!1),b=t(!1),B=t(!1),s=t({phone:"",password:"",confirmPassword:"",verifyCode:"",agreed:!1}),k=/^1[3-9]\d{9}$/,V=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[\w!@#$%^&*]{8,20}$/,N=()=>{y.value=!y.value},H=()=>{E.value=!E.value},j=()=>{q.value=!0,d.value=""},W=()=>{!k.test(s.value.phone)&&s.value.phone.trim()!==""?(p.value=!0,d.value="请输入有效的手机号码"):p.value=!1},X=()=>{z.value=!0,w.value=""},Z=()=>{!V.test(s.value.password)&&s.value.password.trim()!==""?(b.value=!0,w.value="密码需包含大小写字母和数字,8-20位"):b.value=!1},G=()=>{C.value=s.value.password.trim()!==""},J=()=>{L.value=!0,g.value=""},K=()=>{s.value.confirmPassword!==s.value.password&&s.value.password.trim()!==""&&s.value.confirmPassword.trim()!==""?(B.value=!0,g.value="两次输入密码不一致"):B.value=!1},O=()=>{_.value=s.value.confirmPassword.trim()!==""},Q=async()=>{var a,e;if(!h.value)if(k.test(s.value.phone))try{const r=await U({method:"post",url:"/api/send-verify-code",data:{phone:s.value.phone}});if(r.success){h.value=!0,f.value=60;const l=setInterval(()=>{f.value--,f.value<=0&&(clearInterval(l),h.value=!1)},1e3);console.log("验证码发送成功:",r),c.success(r.message),setTimeout(()=>{c.success({message:"验证码为："+r.code,type:"success",duration:5e3})},3e3)}}catch(r){console.error("验证码发送失败:",r),c.error(((e=(a=r.response)==null?void 0:a.data)==null?void 0:e.message)||"验证码发送失败")}else{p.value=!0,d.value="请输入有效的手机号码",setTimeout(()=>{p.value=!1,d.value=""},1e3);return}},Y=async()=>{var a,e;if(F(),!!F())try{P.value=!0;const r=await U({method:"post",url:"/api/register",data:s.value});ee()}catch(r){console.error("注册失败:",r),c.error(((e=(a=r.response)==null?void 0:a.data)==null?void 0:e.message)||"注册失败")}finally{P.value=!1}},ee=()=>{let a=t(2);const e=()=>{c({dangerouslyUseHTMLString:!0,message:`注册成功，即将跳转登录页面（<strong>${a.value}</strong>秒）`,type:"success",duration:0})},r=()=>{const I=document.querySelector(".el-message__content");I&&(I.innerHTML=`注册成功，即将跳转登录页面（<strong>${a.value}</strong>秒）`)};e();const l=setInterval(()=>{a.value--,setTimeout(()=>{r()},0),a.value<=0&&(clearInterval(l),c.closeAll(),$.push("/Login"))},1e3)},F=()=>{let a=!0;return!k.test(s.value.phone)&&s.value.phone.trim()!==""&&(d.value="请输入有效的手机号码",a=!1),!V.test(s.value.password)&&s.value.password.trim()!==""&&(w.value="密码需包含大小写字母和数字,8-20位",a=!1),s.value.password!==s.value.confirmPassword&&!s.value.password.trim()!==""&&!s.value.confirmPassword.trim()!==""&&(g.value="两次输入的密码不一致",a=!1),/^\d{6}$/.test(s.value.verifyCode)?x.value=!1:(x.value="请输入6位正确的验证码",a=!1),s.value.agreed||(A.value=!0,a=!1),a};return(a,e)=>{const r=ne("router-link");return u(),n(le,null,[e[14]||(e[14]=o("div",{class:"register-container"},null,-1)),e[15]||(e[15]=o("div",{class:"register-card-out"},null,-1)),o("div",de,[e[13]||(e[13]=o("h2",null,"欢迎注册",-1)),o("form",{onSubmit:D(Y,["prevent"])},[o("div",ve,[m(o("input",{type:"text",required:"","onUpdate:modelValue":e[0]||(e[0]=l=>s.value.phone=l),onFocus:j,onBlur:W},null,544),[[M,s.value.phone]]),e[5]||(e[5]=o("span",null,"请输入手机号",-1)),p.value?(u(),n("div",ce,v(d.value),1)):i("",!0)]),o("div",fe,[m(o("input",{type:y.value?"text":"password",required:"","onUpdate:modelValue":e[1]||(e[1]=l=>s.value.password=l),onFocus:X,onBlur:Z,onInput:G},null,40,pe),[[S,s.value.password]]),C.value?(u(),n("i",{key:0,onClick:N,class:R(y.value?"fas fa-eye-slash":"fas fa-eye")},null,2)):i("",!0),e[6]||(e[6]=o("span",null,"*请输入密码",-1)),b.value?(u(),n("div",me,v(w.value),1)):i("",!0)]),o("div",we,[m(o("input",{type:E.value?"text":"password",required:"","onUpdate:modelValue":e[2]||(e[2]=l=>s.value.confirmPassword=l),onFocus:J,onBlur:K,onInput:O},null,40,ye),[[S,s.value.confirmPassword]]),_.value?(u(),n("i",{key:0,onClick:H,class:R(E.value?"fas fa-eye-slash":"fas fa-eye")},null,2)):i("",!0),e[7]||(e[7]=o("span",null,"*确认密码",-1)),B.value?(u(),n("div",ge,v(g.value),1)):i("",!0)]),o("a",{href:"#",class:"fsyzm",onClick:D(Q,["prevent"]),disabled:h.value},v(f.value>0?`${f.value}s后重发`:"发送验证码"),9,Ee),o("div",he,[e[8]||(e[8]=o("label",{for:"verify"},"*验证码:",-1)),m(o("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.verifyCode=l),type:"text",id:"verify",class:"yzm-input",maxlength:"6"},null,512),[[M,s.value.verifyCode]]),x.value?(u(),n("div",xe,v(x.value),1)):i("",!0)]),o("div",Pe,[m(o("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>s.value.agreed=l),type:"checkbox",id:"checkbox"},null,512),[[te,s.value.agreed]]),e[9]||(e[9]=o("label",{for:"checkbox",class:"checkbox"},"我已阅读并同意",-1)),e[10]||(e[10]=o("a",{href:"https://metaso.cn/search/8595717277531201536?q=%E3%80%8A%E7%BA%A2%E6%B2%B3%E5%B7%9E%E8%92%99%E8%87%AA%E5%B8%82%E7%9F%B3%E6%A6%B4%E6%97%97%E8%88%B0%E5%BA%97%E3%80%8B%E7%9A%84%E7%94%A8%E6%88%B7%E5%8D%8F%E8%AE%AE%E4%B8%8E%E9%9A%90%E7%A7%81%E6%94%BF%E7%AD%96"},"《用户注册协议》",-1))]),!s.value.agreed&&A.value?(u(),n("div",be," 请同意用户协议 ")):i("",!0),o("div",Be,[o("button",{class:"register-button",disabled:P.value},v(P.value?"注册中...":"注册"),9,ke)])],32),o("span",null,[e[12]||(e[12]=T("已有账号？ ")),ae(r,{to:"Login"},{default:re(()=>e[11]||(e[11]=[T("去登录")])),_:1})])])],64)}}},Te=se(Ce,[["__scopeId","data-v-82e45491"]]);export{Te as default};
