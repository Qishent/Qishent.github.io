import{b as ve,e as x,d as fe,g as K,i as R,u as ge,o as be,E as B,_ as he,w as ye}from"./base-COint-0-.js";import{E as ke,v as Ve}from"./el-pagination-DTA7MzzQ.js";import{E as _e,a as we,b as Ee}from"./el-form-item-Bn7Aetts.js";import{i as Ce,E as Y,a as Ie}from"./el-overlay-iNYs8M_H.js";import{E as Se}from"./el-input-number-sTNu_dmS.js";import{E as Te}from"./el-card-CVV9TqUR.js";/* empty css               */import"./el-select-CNmZmsvv.js";import{a as Pe,E as Ne}from"./el-table-column-z22Suh1D.js";import{E as Be}from"./el-button-Bmuing9d.js";import{H as G,J as oe,c as _,r as E,s as Z,o as ze,j as u,a as w,b as C,f as o,z as b,S as ie,k as m,w as n,l as A,e as v,t as z,d as i,af as De,M as ee,A as le,y as Ae,B as Fe,ag as te,_ as Me,O as ae,n as V,m as Ue}from"./index-D3JvHN-W.js";import{u as $e}from"./productionStore-D1MCfJgG.js";import{E as S}from"./el-message-CSRVETfp.js";import{E as xe}from"./index-BWKcZXvB.js";import{u as Ke}from"./index-Bf6pu-mY.js";import{U as J,C as W,I as Q}from"./event-BB_Ol6Sd.js";import{d as Oe,a as Le,e as je,b as qe}from"./use-form-common-props-BrhWD8tu.js";import{d as He,t as Re}from"./error-Cq9Fpw4b.js";import"./use-global-config-CDcpUNXh.js";import"./aria-Dcom87Zv.js";import"./focus-trap-CJCppc4l.js";import"./index-Ch77k0nh.js";import"./castArray-DcFT1Ym3.js";import"./index-DIeYr67b.js";import"./vnode-Dt7CZ6xF.js";import"./token-DI9FKtlJ.js";import"./debounce-aSiB0j9C.js";const Ge=ve({modelValue:{type:[Boolean,String,Number],default:!1},disabled:Boolean,loading:Boolean,size:{type:String,validator:Ce},width:{type:[String,Number],default:""},inlinePrompt:Boolean,inactiveActionIcon:{type:x},activeActionIcon:{type:x},activeIcon:{type:x},inactiveIcon:{type:x},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:fe(Function)},id:String,tabindex:{type:[String,Number]},...Ke(["ariaLabel"])}),Je={[J]:p=>K(p)||G(p)||R(p),[W]:p=>K(p)||G(p)||R(p),[Q]:p=>K(p)||G(p)||R(p)},ne="ElSwitch",We=oe({name:ne}),Qe=oe({...We,props:Ge,emits:Je,setup(p,{expose:O,emit:g}){const r=p,{formItem:h}=Oe(),F=Le(),a=ge("switch"),{inputId:k}=je(r,{formItemContext:h}),T=qe(_(()=>r.loading)),y=E(r.modelValue!==!1),I=E(),L=E(),j=_(()=>[a.b(),a.m(F.value),a.is("disabled",T.value),a.is("checked",d.value)]),M=_(()=>[a.e("label"),a.em("label","left"),a.is("active",!d.value)]),U=_(()=>[a.e("label"),a.em("label","right"),a.is("active",d.value)]),q=_(()=>({width:be(r.width)}));Z(()=>r.modelValue,()=>{y.value=!0});const P=_(()=>y.value?r.modelValue:!1),d=_(()=>P.value===r.activeValue);[r.activeValue,r.inactiveValue].includes(P.value)||(g(J,r.inactiveValue),g(W,r.inactiveValue),g(Q,r.inactiveValue)),Z(d,e=>{var c;I.value.checked=e,r.validateEvent&&((c=h==null?void 0:h.validate)==null||c.call(h,"change").catch(f=>He()))});const N=()=>{const e=d.value?r.inactiveValue:r.activeValue;g(J,e),g(W,e),g(Q,e),Fe(()=>{I.value.checked=d.value})},l=()=>{if(T.value)return;const{beforeChange:e}=r;if(!e){N();return}const c=e();[te(c),K(c)].includes(!0)||Re(ne,"beforeChange must return type `Promise<boolean>` or `boolean`"),te(c)?c.then($=>{$&&N()}).catch($=>{}):c&&N()},t=()=>{var e,c;(c=(e=I.value)==null?void 0:e.focus)==null||c.call(e)};return ze(()=>{I.value.checked=d.value}),O({focus:t,checked:d}),(e,c)=>(u(),w("div",{class:b(o(j)),onClick:Ae(l,["prevent"])},[C("input",{id:o(k),ref_key:"input",ref:I,class:b(o(a).e("input")),type:"checkbox",role:"switch","aria-checked":o(d),"aria-disabled":o(T),"aria-label":e.ariaLabel,name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:o(T),tabindex:e.tabindex,onChange:N,onKeydown:ie(l,["enter"])},null,42,["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"]),!e.inlinePrompt&&(e.inactiveIcon||e.inactiveText)?(u(),w("span",{key:0,class:b(o(M))},[e.inactiveIcon?(u(),m(o(B),{key:0},{default:n(()=>[(u(),m(A(e.inactiveIcon)))]),_:1})):v("v-if",!0),!e.inactiveIcon&&e.inactiveText?(u(),w("span",{key:1,"aria-hidden":o(d)},z(e.inactiveText),9,["aria-hidden"])):v("v-if",!0)],2)):v("v-if",!0),C("span",{ref_key:"core",ref:L,class:b(o(a).e("core")),style:le(o(q))},[e.inlinePrompt?(u(),w("div",{key:0,class:b(o(a).e("inner"))},[e.activeIcon||e.inactiveIcon?(u(),m(o(B),{key:0,class:b(o(a).is("icon"))},{default:n(()=>[(u(),m(A(o(d)?e.activeIcon:e.inactiveIcon)))]),_:1},8,["class"])):e.activeText||e.inactiveText?(u(),w("span",{key:1,class:b(o(a).is("text")),"aria-hidden":!o(d)},z(o(d)?e.activeText:e.inactiveText),11,["aria-hidden"])):v("v-if",!0)],2)):v("v-if",!0),C("div",{class:b(o(a).e("action"))},[e.loading?(u(),m(o(B),{key:0,class:b(o(a).is("loading"))},{default:n(()=>[i(o(De))]),_:1},8,["class"])):o(d)?ee(e.$slots,"active-action",{key:1},()=>[e.activeActionIcon?(u(),m(o(B),{key:0},{default:n(()=>[(u(),m(A(e.activeActionIcon)))]),_:1})):v("v-if",!0)]):o(d)?v("v-if",!0):ee(e.$slots,"inactive-action",{key:2},()=>[e.inactiveActionIcon?(u(),m(o(B),{key:0},{default:n(()=>[(u(),m(A(e.inactiveActionIcon)))]),_:1})):v("v-if",!0)])],2)],6),!e.inlinePrompt&&(e.activeIcon||e.activeText)?(u(),w("span",{key:1,class:b(o(U))},[e.activeIcon?(u(),m(o(B),{key:0},{default:n(()=>[(u(),m(A(e.activeIcon)))]),_:1})):v("v-if",!0),!e.activeIcon&&e.activeText?(u(),w("span",{key:1,"aria-hidden":!o(d)},z(e.activeText),9,["aria-hidden"])):v("v-if",!0)],2)):v("v-if",!0)],10,["onClick"]))}});var Xe=he(Qe,[["__file","switch.vue"]]);const Ye=ye(Xe),Ze={class:"product-management"},et={class:"operation-bar"},tt={class:"header"},at={class:"search-box"},ot={__name:"Products",setup(p){Array.from({length:50},(l,t)=>({id:t+1,name:`石榴商品 ${t+1}`,price:Math.random()*100+20,stock:Math.floor(Math.random()*200),status:Math.random()>.5}));const O=E(!1),g=E(""),r=E(!1),h=E("add"),F=E(null),a=ae({id:null,name:"",price:0,stock:0,status:!0}),k=ae({current:1,size:10,total:0}),T={name:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:2,max:50,message:"长度在2到50个字符",trigger:"blur"},{validator:(l,t,e)=>{y.productions.some(f=>f.name===t&&f.id!==a.id)?e(new Error("商品名称已存在")):e()},trigger:"blur"}],price:[{required:!0,message:"请输入商品价格",trigger:"blur"},{type:"number",min:.01,message:"价格必须大于0",trigger:"blur"}],stock:[{required:!0,message:"请输入库存数量",trigger:"blur"},{type:"number",min:0,message:"库存不能为负数",trigger:"blur"}]},y=$e(),I=_(()=>y.productions.filter(l=>{const t=g.value.toLowerCase();return l.name.toLowerCase().includes(t)||l.id.toString().includes(t)})),L=async()=>{try{await F.value.validate();const l={...a};if(h.value==="add"){const t=Math.max(...y.productions.map(e=>e.id),0);l.id=t+1,y.addProduction(l),S.success("新增成功")}else y.updateProduction(l),S.success("更新成功");r.value=!1,U()}catch(l){console.error("操作失败:",l),S.error("操作失败，请检查表单")}},j=async l=>{try{await Y.confirm("确认删除该商品吗？","删除确认",{type:"error",confirmButtonText:"确认删除",cancelButtonText:"取消"}),y.deleteProduction(l.id),S.success("删除成功")}catch{S.info("已取消删除")}},M=(l,t)=>{h.value=l,l==="edit"?Object.keys(a).forEach(e=>{a[e]=t[e]}):U(),r.value=!0},U=()=>{Object.assign(a,{id:null,name:"",price:0,stock:0,status:!0})},q=async l=>{try{await Y.confirm(`确认${l.status?"下架":"上架"}该商品吗？`,"操作确认",{type:"warning"}),l.status=!l.status,S.success("状态更新成功")}catch{S.info("已取消操作")}},P=()=>{k.current=1},d=l=>{k.size=l},N=l=>{k.current=l};return(l,t)=>{const e=Be,c=Ie,f=Pe,$=xe,se=Ne,re=ke,ue=Te,H=Se,D=we,de=Ye,ce=Ee,pe=_e,me=Ve;return u(),w("div",Ze,[i(ue,{shadow:"never"},{default:n(()=>[C("div",et,[C("div",tt,[t[10]||(t[10]=C("h2",{class:"title"},"商品管理",-1)),C("div",at,[i(c,{modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=s=>g.value=s),placeholder:"搜索商品名称/ID",clearable:"",onClear:P,onKeyup:ie(P,["enter"])},{append:n(()=>[i(e,{icon:"el-icon-search",onClick:P})]),_:1},8,["modelValue"])]),i(e,{type:"primary",onClick:t[1]||(t[1]=s=>M("add"))},{default:n(()=>t[9]||(t[9]=[C("i",{class:"el-icon-plus"},null,-1),V(" 新增商品 ")])),_:1})]),Ue((u(),m(se,{data:I.value,border:"",style:{width:"100%"},"max-height":600,"row-style":{height:"60px"},"header-row-style":{height:"60px"}},{default:n(()=>[i(f,{prop:"id",label:"ID",width:"80",sortable:"","show-overflow-tooltip":!0,resizable:!0}),i(f,{prop:"name",label:"商品名称","min-width":"150","show-overflow-tooltip":!0,resizable:!0}),i(f,{prop:"price",label:"价格",width:"120",sortable:""},{default:n(({row:s})=>[V("¥"+z(s.price.toFixed(2)),1)]),_:1}),i(f,{prop:"stock",label:"库存",width:"100"}),i(f,{prop:"status",label:"状态",width:"100"},{default:n(({row:s})=>[i($,{type:s.status?"success":"danger"},{default:n(()=>[V(z(s.status?"上架":"下架"),1)]),_:2},1032,["type"])]),_:1}),i(f,{label:"操作",width:"180",fixed:"right"},{default:n(({row:s})=>[i(e,{type:"text",link:"",onClick:X=>M("edit",s)},{default:n(()=>t[11]||(t[11]=[V(" 编辑 ")])),_:2},1032,["onClick"]),i(e,{type:"text",link:"",onClick:X=>q(s),style:le({color:s.status?"#F56C6C":"#67C23A"})},{default:n(()=>[V(z(s.status?"下架":"上架"),1)]),_:2},1032,["onClick","style"]),i(e,{type:"text",link:"",style:{color:"#f56c6c"},onClick:X=>j(s)},{default:n(()=>t[12]||(t[12]=[V(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[me,O.value]]),i(re,{onSizeChange:d,onCurrentChange:N,"current-page":k.current,"page-sizes":[10,20,50,100],"page-size":k.size,layout:"total, sizes, prev, pager, next, jumper",total:k.total},null,8,["current-page","page-size","total"])])]),_:1}),i(pe,{title:h.value==="add"?"新增商品":"编辑商品",modelValue:r.value,"onUpdate:modelValue":t[8]||(t[8]=s=>r.value=s),width:"600px"},{footer:n(()=>[i(e,{onClick:t[7]||(t[7]=s=>r.value=!1)},{default:n(()=>t[13]||(t[13]=[V("取 消")])),_:1}),i(e,{type:"primary",onClick:L},{default:n(()=>t[14]||(t[14]=[V("确 定")])),_:1})]),default:n(()=>[i(ce,{model:a,rules:T,ref_key:"productForm",ref:F,"label-width":"100px"},{default:n(()=>[h.value==="edit"?(u(),m(D,{key:0,label:"商品ID",prop:"id"},{default:n(()=>[i(H,{modelValue:a.id,"onUpdate:modelValue":t[2]||(t[2]=s=>a.id=s),min:1,step:1,"controls-position":"right",disabled:""},null,8,["modelValue"])]),_:1})):v("",!0),i(D,{label:"商品名称",prop:"name"},{default:n(()=>[i(c,{modelValue:a.name,"onUpdate:modelValue":t[3]||(t[3]=s=>a.name=s),placeholder:"请输入商品名称",clearable:""},null,8,["modelValue"])]),_:1}),i(D,{label:"价格",prop:"price"},{default:n(()=>[i(H,{modelValue:a.price,"onUpdate:modelValue":t[4]||(t[4]=s=>a.price=s),min:.01,precision:2,step:.1,"controls-position":"right"},null,8,["modelValue"])]),_:1}),i(D,{label:"库存",prop:"stock"},{default:n(()=>[i(H,{modelValue:a.stock,"onUpdate:modelValue":t[5]||(t[5]=s=>a.stock=s),min:0,step:1,"controls-position":"right"},null,8,["modelValue"])]),_:1}),i(D,{label:"商品状态",prop:"status"},{default:n(()=>[i(de,{modelValue:a.status,"onUpdate:modelValue":t[6]||(t[6]=s=>a.status=s),"active-text":"上架","inactive-text":"下架"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},Bt=Me(ot,[["__scopeId","data-v-7d4b2a2f"]]);export{Bt as default};
