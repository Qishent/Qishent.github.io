import{Q as V,ae as he,J as te,N as U,r as S,c as u,R as _,a4 as q,a5 as T,H as G,s as be,j as d,a as v,F as N,g as ye,z as m,f as o,d as J,w as Q,m as X,k as w,l as x,v as Y,e as D,A as H,t as Ve}from"./index-Bcu1wmac.js";import{b as we,d as M,e as Z,f as xe,i as ee,u as Ce,E as ae,n as le,_ as Ie,w as ge}from"./base-FLaoZt01.js";import{m as oe,E as C}from"./aria-Dcom87Zv.js";import{u as Ee}from"./index-CW4qdgPr.js";import{C as k,U as I}from"./event-BB_Ol6Sd.js";import{a as Se,e as _e,f as Te,g as Ne}from"./use-form-common-props-aUHwGn2-.js";const De=we({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:M([Array,Object]),default:()=>oe(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:M([Array,Object]),default:()=>[V,V,V]},voidIcon:{type:Z,default:()=>he},disabledVoidIcon:{type:Z,default:()=>V},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:M(Array),default:()=>oe(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:xe,clearable:Boolean,...Ee(["ariaLabel"])}),He={[k]:p=>ee(p),[I]:p=>ee(p)},Me=te({name:"ElRate"}),ke=te({...Me,props:De,emits:He,setup(p,{expose:se,emit:h}){const e=p;function g(a,l){const t=n=>q(n),i=Object.keys(l).map(n=>+n).filter(n=>{const y=l[n];return(t(y)?y.excluded:!1)?a<n:a<=n}).sort((n,y)=>n-y),b=l[i[0]];return t(b)&&b.value||b}const A=U(Te,void 0),B=U(Ne,void 0),re=Se(),r=Ce("rate"),{inputId:ne,isLabeledByFormItem:P}=_e(e,{formItemContext:B}),s=S(e.modelValue),E=S(-1),f=S(!0),ue=u(()=>[r.b(),r.m(re.value)]),c=u(()=>e.disabled||(A==null?void 0:A.disabled)),ie=u(()=>r.cssVarBlock({"void-color":e.voidColor,"disabled-void-color":e.disabledVoidColor,"fill-color":F.value})),j=u(()=>{let a="";return e.showScore?a=e.scoreTemplate.replace(/\{\s*value\s*\}/,c.value?`${e.modelValue}`:`${s.value}`):e.showText&&(a=e.texts[Math.ceil(s.value)-1]),a}),z=u(()=>e.modelValue*100-Math.floor(e.modelValue)*100),de=u(()=>_(e.colors)?{[e.lowThreshold]:e.colors[0],[e.highThreshold]:{value:e.colors[1],excluded:!0},[e.max]:e.colors[2]}:e.colors),F=u(()=>{const a=g(s.value,de.value);return q(a)?"":a}),ce=u(()=>{let a="";return c.value?a=`${z.value}%`:e.allowHalf&&(a="50%"),{color:F.value,width:a}}),O=u(()=>{let a=_(e.icons)?[...e.icons]:{...e.icons};return a=T(a),_(a)?{[e.lowThreshold]:a[0],[e.highThreshold]:{value:a[1],excluded:!0},[e.max]:a[2]}:a}),fe=u(()=>g(e.modelValue,O.value)),L=u(()=>c.value?G(e.disabledVoidIcon)?e.disabledVoidIcon:T(e.disabledVoidIcon):G(e.voidIcon)?e.voidIcon:T(e.voidIcon)),ve=u(()=>g(s.value,O.value));function K(a){const l=c.value&&z.value>0&&a-1<e.modelValue&&a>e.modelValue,t=e.allowHalf&&f.value&&a-.5<=s.value&&a>s.value;return l||t}function R(a){e.clearable&&a===e.modelValue&&(a=0),h(I,a),e.modelValue!==a&&h(k,a)}function me(a){c.value||(e.allowHalf&&f.value?R(s.value):R(a))}function pe(a){if(c.value)return;let l=s.value;const t=a.code;return t===C.up||t===C.right?(e.allowHalf?l+=.5:l+=1,a.stopPropagation(),a.preventDefault()):(t===C.left||t===C.down)&&(e.allowHalf?l-=.5:l-=1,a.stopPropagation(),a.preventDefault()),l=l<0?0:l,l=l>e.max?e.max:l,h(I,l),h(k,l),l}function $(a,l){if(!c.value){if(e.allowHalf&&l){let t=l.target;le(t,r.e("item"))&&(t=t.querySelector(`.${r.e("icon")}`)),(t.clientWidth===0||le(t,r.e("decimal")))&&(t=t.parentNode),f.value=l.offsetX*2<=t.clientWidth,s.value=f.value?a-.5:a}else s.value=a;E.value=a}}function W(){c.value||(e.allowHalf&&(f.value=e.modelValue!==Math.floor(e.modelValue)),s.value=e.modelValue,E.value=-1)}return be(()=>e.modelValue,a=>{s.value=a,f.value=e.modelValue!==Math.floor(e.modelValue)}),e.modelValue||h(I,0),se({setCurrentValue:$,resetCurrentValue:W}),(a,l)=>{var t;return d(),v("div",{id:o(ne),class:m([o(ue),o(r).is("disabled",o(c))]),role:"slider","aria-label":o(P)?void 0:a.ariaLabel||"rating","aria-labelledby":o(P)?(t=o(B))==null?void 0:t.labelId:void 0,"aria-valuenow":s.value,"aria-valuetext":o(j)||void 0,"aria-valuemin":"0","aria-valuemax":a.max,tabindex:"0",style:H(o(ie)),onKeydown:pe},[(d(!0),v(N,null,ye(a.max,(i,b)=>(d(),v("span",{key:b,class:m(o(r).e("item")),onMousemove:n=>$(i,n),onMouseleave:W,onClick:n=>me(i)},[J(o(ae),{class:m([o(r).e("icon"),{hover:E.value===i},o(r).is("active",i<=s.value)])},{default:Q(()=>[K(i)?D("v-if",!0):(d(),v(N,{key:0},[X((d(),w(x(o(ve)),null,null,512)),[[Y,i<=s.value]]),X((d(),w(x(o(L)),null,null,512)),[[Y,!(i<=s.value)]])],64)),K(i)?(d(),v(N,{key:1},[(d(),w(x(o(L)),{class:m([o(r).em("decimal","box")])},null,8,["class"])),J(o(ae),{style:H(o(ce)),class:m([o(r).e("icon"),o(r).e("decimal")])},{default:Q(()=>[(d(),w(x(o(fe))))]),_:1},8,["style","class"])],64)):D("v-if",!0)]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),a.showText||a.showScore?(d(),v("span",{key:0,class:m(o(r).e("text")),style:H({color:a.textColor})},Ve(o(j)),7)):D("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}});var Ae=Ie(ke,[["__file","rate.vue"]]);const Ke=ge(Ae);export{Ke as E};
